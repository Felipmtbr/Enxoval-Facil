<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enxoval de Casa Nova</title>
    <style>
        /* Seu estilo permanece o mesmo */
    </style>
</head>
<body>
    <div class="container">
        <h2>Monte seu Enxoval</h2>
        
        <div class="button-group">
            <button class="essential-btn" onclick="showEssentialEnxoval()">Enxoval Essencial</button>
            <button class="full-btn" onclick="showFullEnxoval()">Enxoval Completo</button>
        </div>

        <div id="enxoval-details"></div>

        <button class="save-btn" onclick="saveProgress()">Salvar Alterações</button>
    </div>

    <script>
        // Variáveis para armazenar os itens do enxoval
        let essentialItems = [
            { category: 'Quarto', item: 'Colchão', price: 700, acquired: false },
            { category: 'Quarto', item: 'Cama', price: 350, acquired: false },
            // outros itens essenciais...
        ];

        let fullItems = [
            { category: 'Quarto', item: 'Cama Box com Colchão', price: 1200, acquired: false },
            { category: 'Sala', item: 'Sofá', price: 1500, acquired: false },
            // outros itens completos...
        ];

        // Carregar os dados do LocalStorage quando a página for carregada
        window.onload = function() {
            loadProgress();
        }

        // Carregar os dados do LocalStorage
        function loadProgress() {
            const savedEssentialItems = JSON.parse(localStorage.getItem('essentialItems'));
            const savedFullItems = JSON.parse(localStorage.getItem('fullItems'));

            if (savedEssentialItems) {
                essentialItems = savedEssentialItems;
            }
            if (savedFullItems) {
                fullItems = savedFullItems;
            }
        }

        // Salvar os dados no LocalStorage
        function saveProgress() {
            localStorage.setItem('essentialItems', JSON.stringify(essentialItems));
            localStorage.setItem('fullItems', JSON.stringify(fullItems));
            alert('Alterações salvas!');
        }

        // Exibir o enxoval essencial
        function showEssentialEnxoval() {
            let essentialEnxoval = '';
            const categories = ['Quarto', 'Sala', 'Cozinha', 'Banheiro', 'Utilidades'];

            categories.forEach(category => {
                const itemsInCategory = essentialItems.filter(item => item.category === category);
                essentialEnxoval += generateCategoryTable(category, itemsInCategory, 'essencial');
            });

            document.getElementById('enxoval-details').innerHTML = essentialEnxoval;
        }

        // Exibir o enxoval completo
        function showFullEnxoval() {
            let fullEnxoval = '';
            const categories = ['Quarto', 'Sala', 'Cozinha'];

            categories.forEach(category => {
                const itemsInCategory = fullItems.filter(item => item.category === category);
                fullEnxoval += generateCategoryTable(category, itemsInCategory, 'completo');
            });

            document.getElementById('enxoval-details').innerHTML = fullEnxoval;
        }

        // Gerar a tabela de itens por categoria
        function generateCategoryTable(category, items, enxovalType) {
            let categoryTable = `
                <h3>${category}</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Preço (R$)</th>
                            <th>Adquirido?</th>
                            <th>Valor Pago</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            let totalInvestido = 0;
            items.forEach(item => {
                categoryTable += `
                    <tr>
                        <td>${item.item}</td>
                        <td>${item.price.toFixed(2)}</td>
                        <td><input type="checkbox" onclick="markItem(this, ${item.price}, '${enxovalType}', '${category}', '${item.item}')"></td>
                        <td><input type="number" onchange="updateValue(this, ${item.price}, '${enxovalType}', '${category}', '${item.item}')"></td>
                    </tr>
                `;
                totalInvestido += item.price;
            });

            categoryTable += `
                <tr class="total-row">
                    <td colspan="3">Total Investido:</td>
                    <td id="total-investido-${enxovalType}-${category}">R$ ${totalInvestido.toFixed(2)}</td>
                </tr>
                <tr class="total-row">
                    <td colspan="3">Total Restante:</td>
                    <td id="total-restante-${enxovalType}-${category}">R$ ${calculateRemaining(category, enxovalType)}</td>
                </tr>
                <tr class="total-row">
                    <td colspan="3">Próximo Item a Adquirir:</td>
                    <td id="proximo-item-${enxovalType}-${category}">${getNextItem(items)}</td>
                </tr>
                </tbody>
            </table>
            `;

            return categoryTable;
        }

        // Calcular o total restante da categoria
        function calculateRemaining(category, enxovalType) {
            const items = enxovalType === 'essencial' ? essentialItems : fullItems;
            const itemsInCategory = items.filter(item => item.category === category);
            const totalCategoryValue = itemsInCategory.reduce((acc, item) => acc + item.price, 0);
            const totalInvestidoInCategory = itemsInCategory.reduce((acc, item) => {
                return item.acquired ? acc + item.price : acc;
            }, 0);

            return (totalCategoryValue - totalInvestidoInCategory).toFixed(2);
        }

        // Obter o próximo item a ser adquirido
        function getNextItem(items) {
            const remainingItems = items.filter(item => !item.acquired);
            return remainingItems.length > 0 ? remainingItems[0].item : "Nenhum item restante";
        }

        // Marcar um item como adquirido
        function markItem(checkbox, value, enxovalType, category, itemName) {
            const item = (enxovalType === 'essencial' ? essentialItems : fullItems).find(item => item.category === category && item.item === itemName);
            item.acquired = checkbox.checked;
            updateTotals(category, enxovalType);
        }

        // Atualizar o valor de um item
        function updateValue(input, value, enxovalType, category, itemName) {
            const item = (enxovalType === 'essencial' ? essentialItems : fullItems).find(item => item.category === category && item.item === itemName);
            const newValue = parseFloat(input.value) || 0;
            item.price = newValue;
            updateTotals(category, enxovalType);
        }

        // Atualizar os totais de cada categoria
        function updateTotals(category, enxovalType) {
            let totalInvestido = 0;
            const items = enxovalType === 'essencial' ? essentialItems : fullItems;
            items.filter(item => item.category === category).forEach(item => {
                if (item.acquired) {
                    totalInvestido += item.price;
                }
            });

            document.getElementById(`total-investido-${enxovalType}-${category}`).textContent = `R$ ${totalInvestido.toFixed(2)}`;
            document.getElementById(`total-restante-${enxovalType}-${category}`).textContent = `R$ ${calculateRemaining(category, enxovalType)}`;
            document.getElementById(`proximo-item-${enxovalType}-${category}`).textContent = getNextItem(items);
        }
    </script>
</body>
</html>